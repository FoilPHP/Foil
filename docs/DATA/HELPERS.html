<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Giuseppe Mazzapica">
    <title>Data / Data Helpers. Foil: PHP Template Engine</title>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300|Source+Code+Pro:400' rel='stylesheet' type='text/css'>
    <link href="http://www.foilphp.it/css/theme.min.css" rel="stylesheet">
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <div id="wrapper">

      <!-- Sidebar -->
      <div id="sidebar-wrapper">
          <ul class="sidebar-nav">
                                                  <li>
                      <a class="section" href="#sidebar-wrapper"><i class="fa fa-caret-right"></i> Getting Started</a>
                      <ul>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/GETTING-STARTED/INSTALLATION.html">
                                      Installation
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/GETTING-STARTED/ENGINE.html">
                                      Engine
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/GETTING-STARTED/FOLDERS.html">
                                      Folders
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/GETTING-STARTED/FILE-EXTENSIONS.html">
                                      File Extensions
                                  </a>
                              </li>
                                                </ul>
                    </li>
                                    <li>
                      <a class="section" href="#sidebar-wrapper"><i class="fa fa-caret-right"></i> Templates</a>
                      <ul>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/TEMPLATES/OVERVIEW.html">
                                      Overview
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/TEMPLATES/INHERITANCE.html">
                                      Template Inheritance
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/TEMPLATES/PARTIALS.html">
                                      Partials
                                  </a>
                              </li>
                                                </ul>
                    </li>
                                    <li>
                      <a class="section" href="#sidebar-wrapper"><i class="fa fa-caret-right"></i> Data</a>
                      <ul>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/DATA/PASS-DATA.html">
                                      Pass Data To Templates
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/DATA/CONTEXT-API.html">
                                      Context API
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/DATA/RETRIEVE-DATA.html">
                                      Retrieve Data Inside Templates
                                  </a>
                              </li>
                                                        <li class="active">
                                  <a href="http://www.foilphp.it/docs/DATA/HELPERS.html">
                                      Data Helpers
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/DATA/FILTERS.html">
                                      Data Filters
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/DATA/ARRAIZATION.html">
                                      Arraization
                                  </a>
                              </li>
                                                </ul>
                    </li>
                                    <li>
                      <a class="section" href="#sidebar-wrapper"><i class="fa fa-caret-right"></i> Functions</a>
                      <ul>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/FUNCTIONS/LOOP-HELPERS.html">
                                      Loop Helpers
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/FUNCTIONS/ARRAY-HELPERS.html">
                                      Array Helpers
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/FUNCTIONS/LINK-HELPERS.html">
                                      Link Helpers
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/FUNCTIONS/URI-HELPERS.html">
                                      Uri Helpers
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/FUNCTIONS/HTML-HELPERS.html">
                                      HTML and Form Helpers
                                  </a>
                              </li>
                                                </ul>
                    </li>
                                    <li>
                      <a class="section" href="#sidebar-wrapper"><i class="fa fa-caret-right"></i> Extending Foil</a>
                      <ul>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/EXTENDING/FUNCTIONS-AND-FILTERS.html">
                                      Custom Functions and Filters
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/EXTENDING/CUSTOM-EXTENSIONS.html">
                                      Custom Foil Extensions
                                  </a>
                              </li>
                                                </ul>
                    </li>
                                    <li>
                      <a class="section" href="#sidebar-wrapper"><i class="fa fa-caret-right"></i> Integrate Foil</a>
                      <ul>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/INTEGRATE/OVERVIEW.html">
                                      Overview
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/INTEGRATE/API.html">
                                      API Functions
                                  </a>
                              </li>
                                                </ul>
                    </li>
                                        </ul>
      </div>
      <!-- /#sidebar-wrapper -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <div class="container-fluid">
                <div class="row">
                    <div id="content" class="col-lg-11">
                                                <ol class="breadcrumb">
                          <li><a href="http://www.foilphp.it">Foil</a></li>
                          <li class="active">Data</li>
                        </ol>
                                                <!--
currentMenu: "datahelpers"
currentSection: "Data"
title: "Data Helpers"
-->
<h1>Data Helpers</h1>
<p>Foil comes with a set of helpers that facilitate the handling of template data.</p>
<p>They are:</p>
<ul>
<li><code>raw()</code></li>
<li><code>e()</code></li>
<li><code>eJs()</code>, <code>eCss()</code>, <code>eAttr()</code></li>
<li><code>d()</code></li>
<li><code>v()</code></li>
<li><code>a()</code></li>
<li><code>ifnot()</code></li>
</ul>
<p>All of them share <strong>same signature</strong> and support:</p>
<ul>
<li>dot syntax to access variables in nested arrays</li>
<li>default value for non existent variables</li>
<li>filters</li>
</ul>
<h2>Helpers Signature</h2>
<p>All helpers listed above share same signature, below there is an example using <code>v()</code>:</p>
<pre><code class="language-php">/**
 * @param string       $var     Variable name, usually is the key in the data array passed to render()
 * @param mixed        $default Returned when requested variable is not defined
 * @param string|array $filter  Filter(s) to apply to retrieved variable (or to default)
 *
 * @return mixed
 */
function v($var, $default = '', $filter = null);</code></pre>
<h1>Helpers Functions</h1>
<h2><code>raw()</code></h2>
<p>This helper allows to output unescaped strings when autoescape is turned on.</p>
<h2><code>e()</code></h2>
<p>This helper is used to get and escape a variable when autoescape is turned off.</p>
<pre><code class="language-php">// assuming $this-&gt;a_var_with_html is '&lt;strong&gt;I am "bold"&lt;/strong&gt;'
echo $this-&gt;e('a_var_with_html'); // echo &amp;lt;strong&amp;gt;I am &amp;quot;bold&amp;quot;&amp;lt;/strong&amp;gt;</code></pre>
<p>Note that the encode routine applied is the same Foil uses when autoescape is turned on, that is capable to encode strings and also arrays containing strings. It is based on <a href="https://github.com/auraphp/Aura.Html">AuraPhp/HTML</a> library.</p>
<p>For example:</p>
<pre><code class="language-php">/*
Assuming $this-&gt;an_array is equal to:
[
    'one' =&gt; '&lt;b&gt;A&lt;/b&gt;'
    'two' =&gt; [
      'a'     =&gt; '&lt;b&gt;A&lt;/b&gt;',
      'three' =&gt; [
            'a' =&gt; '&lt;b&gt;A&lt;/b&gt;',
            'b' =&gt; '&lt;b&gt;B&lt;/b&gt;',
            'c' =&gt; '&lt;b&gt;C&lt;/b&gt;',
      ]
    ]
]
*/

$this-&gt;e('an_array');

/*
Returns:
[
    'one' =&gt; '&amp;lt;b&amp;gt;A&amp;lt;/b&amp;gt'
    'two' =&gt; [
        'a'     =&gt; '&amp;lt;b&amp;gt;A&amp;lt;/b&amp;gt',
        'three' =&gt; [
              'a' =&gt; '&amp;lt;b&amp;gt;A&amp;lt;/b&amp;gt',
              'b' =&gt; '&amp;lt;b&amp;gt;B&amp;lt;/b&amp;gt',
              'c' =&gt; '&amp;lt;b&amp;gt;B&amp;lt;/b&amp;gt',
        ]
    ]
]
*/</code></pre>
<p>This helper, just like the others, accepts a variable <em>name</em>, but if you need to escape a <em>value</em>, you can use the <code>escape()</code> function (or its alias <code>ee()</code>).</p>
<p>For example, the following three lines below are equivalent:</p>
<pre><code class="language-php">echo $this-&gt;e('var_name');

echo $this-&gt;escape($this-&gt;raw('var_name'));

echo $this-&gt;ee($this-&gt;raw('var_name'));</code></pre>
<h2><code>eJs()</code>, <code>eCss()</code>, <code>eAttr()</code></h2>
<p><code>e()</code> helper uses <a href="https://github.com/auraphp/Aura.Html">AuraPhp/HTML</a> library to escaping data. That library allows to use a different escaping "targets".</p>
<p>In fact, it is possible to properly escape data to be placed inside JavaScript scripts, inside CSS or inside HTML attributes.</p>
<p><code>eJs()</code>, <code>eCss()</code> and <code>eAttr()</code> can be used to escape data (strings or array containing strings) that have to be used, respectively, for JavaScript, CSS or HTML attributes.</p>
<p>When using the helpers <code>escape()</code> (or its alias (<code>ee()</code>) is possible to use a second argument ot use an alternative escape target, e.g.:</p>
<pre><code class="language-php">$this-&gt;escape($data, 'js');</code></pre>
<h2><code>v()</code></h2>
<p>"v" stands for "variable" and, as you can guess, returns a template variable.</p>
<p>When autoescape is turned on <code>v()</code> acts like <code>e()</code> otherwise acts as <code>raw()</code>.</p>
<h2><code>a()</code></h2>
<p>"a" stands for "array" and it acts similar to <code>v()</code> but ensures that the returned value is an array and assumes an empty array as default.</p>
<p>It is useful to be used in situations where an array is required, e. g. to be used in <code>foreach</code>.</p>
<pre><code class="language-php">foreach($this-&gt;a('a_variable') as $item) {
  echo $item;
}</code></pre>
<p>Note that if the variable is not defined or empty code above just echo nothing, without the need to check if variable is set and has proper type.</p>
<p>Internally this helper uses the function <code>Foil\arraize()</code> to assure the value you get is an array.
Please read <em>"Data / Arraization"</em> docs page to understand how it works (at the page end of that page there are notes regarding this helper).</p>
<h2><code>araw()</code></h2>
<p>Similar to <code>a()</code> but doesn't escape retrieved array even if autoescape is turned on.</p>
<h2><code>d()</code></h2>
<p>This is the exact counter part of <code>e()</code>: it decode HTML entities. It can be handy when there are a lot of data, e.g. a big array, and only one variable contain trusted HTML content.</p>
<p>Instead of retrieving the array using <code>raw()</code> and then escape one by one all the values, is far easier retrieve it escaped with <code>v()</code> (or <code>a()</code>) and then
<em>decode</em> the only var that contain HTML.</p>
<p>You should use this function only when the variable is trusted.</p>
<p>This helper, just like the others, accepts a variable <em>name</em>, but if you need to decode a <em>value</em>, you can use the <code>decode()</code> function (or its alias <code>dd()</code>).</p>
<p>For example, the following three lines below are equivalent:</p>
<pre><code class="language-php">echo $this-&gt;d('var_name');

echo $this-&gt;decode($this-&gt;e('var_name'));

echo $this-&gt;decode($this-&gt;e('var_name'));</code></pre>
<h2><code>ifnot()</code></h2>
<p>This helper has same signature of the others, and just like the others returns the default value if the variable is not defined,
however, it also outputs default even if the variable is defined but empty. On the contrary if the variable is defined and not empty returns nothing.</p>
<p>Below there is an example of how this helper can be used in combination with <code>a()</code> helper to reproduce something that in <a href="http://twig.sensiolabs.org/doc/tags/for.html#the-else-clause">Twig is done via <code>for</code> / <code>else</code></a>:</p>
<pre><code class="language-php">&lt;ul&gt;
    &lt;?php foreach($this-&gt;a('users') as $user) : ?&gt;
        &lt;li&gt;&lt;?= $user['username'] ?&gt;&lt;/li&gt;
    &lt;?php endforeach ?&gt;

    &lt;?= $this-&gt;ifnot('users', '&lt;li&gt;&lt;em&gt;no user found&lt;/em&gt;&lt;/li&gt;') ?&gt;
&lt;/ul&gt;</code></pre>
<p>Continue reading to the <strong><em>"Default"</em></strong> section further in this page to see how to easily set multiline HTML content as default.</p>
<h1>Helpers Features</h1>
<h2>Dot Syntax</h2>
<p>All helpers support dot syntax to access variables in nested arrays.</p>
<pre><code class="language-php">$data = [
  'a' =&gt; [
    'pretty' =&gt; [
      'deep' =&gt; [
        'var' =&gt; 'Hello World'
      ]
    ]
  ]
];

$engine-&gt;render('template', $data);</code></pre>
<p>Assuming code above, in the <code>template.php</code> file is possible to echo "Hello World" with:</p>
<pre><code class="language-php">&lt;?= $this-&gt;v('a.pretty.deep.var') ?&gt;</code></pre>
<p>Nice thing is there is no need to recursively check for a key existence in a deep array, because if any of the keys doesn't exist the helper just returns an empty string without throwing any error.</p>
<pre><code class="language-php">&lt;?= $this-&gt;v('a.pretty.inexistent.var') // echo nothing ?&gt;</code></pre>
<p>Without this helper, the necessary code to obtain the same result of the single line above would be something like:</p>
<pre><code class="language-php">$a = isset($this-&gt;a) ? $this-&gt;a : null;
if (
  is_array($a)
  &amp;&amp; isset($a['pretty'])
  &amp;&amp; isset($a['pretty']['deep'])
  &amp;&amp; is_array($a['pretty']['deep'])
  &amp;&amp; isset($a['pretty']['deep']['var'])
) {
  echo $a['pretty']['deep']['var'];
}</code></pre>
<h2>Default</h2>
<p>All helpers support as 2nd argument a default value to be returned if required variable is not defined.</p>
<pre><code class="language-php">&lt;?= $this-&gt;v('a.non.defined.variable', 'Default!') // echo "Default!" ?&gt;</code></pre>
<h3>Closures as Default</h3>
<p>There is a special case: when default is an <a href="http://php.net/manual/en/functions.anonymous.php"><strong>anonymous function</strong></a>.</p>
<p>In that case, the anonymous function is ran and the result is returned.
Moreover, if the anonymous function returns nothing, but echoes something, whatever it echoes is returned.</p>
<p>This feature can be used to easily output multiline HTML markup as default:</p>
<pre><code class="language-php">&lt;?= $this-&gt;v('a.non.defined.variable', function() { ?&gt;
    &lt;div&gt;
        &lt;h1&gt;Sorry!&lt;/h1&gt;
        &lt;p&gt;The variable is not defined...&lt;/p&gt;
    &lt;/div&gt;
&lt;?php }) ?&gt;</code></pre>
<h3>Partials as Default</h3>
<p>You might think that partials, returned via <code>insert()</code>, could be a concise way to write big and reusable blocks of HTML content:</p>
<pre><code class="language-php">&lt;?= $this-&gt;v('a.non.defined.variable', $this-&gt;insert('default-partial')) ?&gt;</code></pre>
<p>However there's an issue: when autoescape is turned on, default content is escaped too, so all the content of the template is HTML encoded.</p>
<p>The easiest way to overcome this issue is to use the <a href="http://php.net/manual/en/language.operators.comparison.php#language.operators.comparison.ternary">ternary operator</a> instead of using <code>insert()</code> for 2nd argument:</p>
<pre><code class="language-php">&lt;?= $this-&gt;v('a.non.defined.variable') ?: $this-&gt;insert('default-partial') ?&gt;</code></pre>
<h2>Filters</h2>
<p>Filters are callbacks that modify a variable value. Foil comes with several ready-made filters, but is also possible to register custom ones.</p>
<p>All helpers support as third argument one or more filters to be applied to a variable (or to default value, if variable is not defined).</p>
<p>One of the filters shipped with Foil is <code>'escape'</code> that act in the same way of <code>e()</code> helper.</p>
<p>The two lines in code below are equivalent.</p>
<pre><code class="language-php">$this-&gt;raw('a.var', '', 'escape');

$this-&gt;e('a.var', '');</code></pre>
<p>See <em>"Data / Filters"</em> docs section to know all filters shipped with Foil, and <em>"Extending Foil"</em> to know more about custom filters.</p>
<h2>Filters "Waterfall"</h2>
<p>In a single line is possible to apply more filters to a variable, where each filter is applied on the result of the previous.</p>
<p>To apply more filters is possible to pass all filter names as an array or as a pipe-separated string:</p>
<pre><code class="language-php">/* Assuming "var_name" variable is equal to:

[
    'items' =&gt; [
        'one' =&gt; '&lt;b&gt;One&lt;/b&gt;',
        'two' =&gt; '&lt;b&gt;Two&lt;/b&gt;'
    ]
]
*/

$this-&gt;raw('var_name.items', '', 'escape|first');       // &amp;lt;b&amp;gtOne;&amp;lt;/b&amp;gt;
$this-&gt;raw('var_name.items', '', ['escape', 'first']);  // &amp;lt;b&amp;gtOne;&amp;lt;/b&amp;gt;</code></pre>
<p>Code above makes use of <code>'first'</code> filter that is another of the filters shipped with Foil and returns first element of an array.</p>
<p>All helpers support another way to apply one or more filters to a variable.
Filters can also be set using a pipe-separated list of filters after variable name in helper first argument:</p>
<pre><code class="language-php">$this-&gt;raw('var_name.items|escape|first');              // &amp;lt;b&amp;gtOne;&amp;lt;/b&amp;gt;
$this-&gt;raw('var_name.items', '', 'escape|first');       // &amp;lt;b&amp;gtOne;&amp;lt;/b&amp;gt;
$this-&gt;raw('var_name.items', '', ['escape', 'first']);  // &amp;lt;b&amp;gtOne;&amp;lt;/b&amp;gt;</code></pre>
<p>Looking at the code right above, you can realize that none of the three methods to apply filters allows to pass additional arguments to filter callbacks, and the only argument that filter callbacks receives is the variable to be filtered.</p>
<p>If your filter callbacks need additional arguments, you have to use the <code>filter()</code> template function.</p>
<p>You can find documentation for that function and for the related helper <code>f()</code> in the <em>"Data / Filters"</em> docs section.</p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /#page-content-wrapper -->

                    <a href="https://github.com/Giuseppe-Mazzapica/Foil">
                <img style="position:fixed; top:0; right:0; border:0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png">
            </a>
                <a href="#" id="menu-toggle" title="Toggle Menu"><i class="fa fa-bars"></i></a>


    </div>
    <!-- /#wrapper -->

    <footer class="footer hidden-xs hidden-sm">
      Made by hands by
      <a href="http://gm.zoomlab.it/" title="Giuseppe Mazzapica Home Page" target="_blank">Giuseppe Mazzapica</a>, with
      <a href="http://couscous.io/" title="Couscous" target="_blank">Couscous</a>,
      <a href="http://getbootstrap.com/" title="Bootstrap" target="_blank">Bootstrap</a> &amp;
      <a href="https://highlightjs.org/" title="highlight.js" target="_blank">highlight.js</a>

      <span class="socials">
        <a href="https://github.com/Giuseppe-Mazzapica" title="GitHub" target="_blank"><i class="fa fa-github-alt"></i></a>
        <a href="https://twitter.com/gmazzap" title="Twitter" target="_blank"><i class="fa fa-twitter"></i></a>
        <a href="http://wordpress.stackexchange.com/users/35541/" title="Stack Exchange" target="_blank"><i class="fa fa-stack-exchange"></i></a>
      </span>

    </footer>

    <a href="#wrapper" class="hidden-xs hidden-sm" id="back-top" title="Back to top"><i class="fa fa-long-arrow-up"></i></a>
    <script src="http://yandex.st/highlightjs/7.5/highlight.min.js"></script>
    <script src="http://www.foilphp.it/js/theme.min.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-46467639-2', 'auto');
      ga('send', 'pageview');
    </script>

</body>

</html>
