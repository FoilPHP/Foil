<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Giuseppe Mazzapica">
    <title>Data / Retrieve Data Inside Templates. Foil: PHP Template Engine</title>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300|Source+Code+Pro:400' rel='stylesheet' type='text/css'>
    <link href="http://www.foilphp.it/css/theme.min.css" rel="stylesheet">
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <div id="wrapper">

      <!-- Sidebar -->
      <div id="sidebar-wrapper">
          <ul class="sidebar-nav">
                                                  <li>
                      <a class="section" href="#sidebar-wrapper"><i class="fa fa-caret-right"></i> Getting Started</a>
                      <ul>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/GETTING-STARTED/INSTALLATION.html">
                                      Installation
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/GETTING-STARTED/ENGINE.html">
                                      Engine
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/GETTING-STARTED/FOLDERS.html">
                                      Folders
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/GETTING-STARTED/FILE-EXTENSIONS.html">
                                      File Extensions
                                  </a>
                              </li>
                                                </ul>
                    </li>
                                    <li>
                      <a class="section" href="#sidebar-wrapper"><i class="fa fa-caret-right"></i> Templates</a>
                      <ul>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/TEMPLATES/OVERVIEW.html">
                                      Overview
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/TEMPLATES/INHERITANCE.html">
                                      Template Inheritance
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/TEMPLATES/PARTIALS.html">
                                      Partials
                                  </a>
                              </li>
                                                </ul>
                    </li>
                                    <li>
                      <a class="section" href="#sidebar-wrapper"><i class="fa fa-caret-right"></i> Data</a>
                      <ul>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/DATA/PASS-DATA.html">
                                      Pass Data To Templates
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/DATA/CONTEXT-API.html">
                                      Context API
                                  </a>
                              </li>
                                                        <li class="active">
                                  <a href="http://www.foilphp.it/docs/DATA/RETRIEVE-DATA.html">
                                      Retrieve Data Inside Templates
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/DATA/HELPERS.html">
                                      Data Helpers
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/DATA/FILTERS.html">
                                      Data Filters
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/DATA/ARRAIZATION.html">
                                      Arraization
                                  </a>
                              </li>
                                                </ul>
                    </li>
                                    <li>
                      <a class="section" href="#sidebar-wrapper"><i class="fa fa-caret-right"></i> Functions</a>
                      <ul>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/FUNCTIONS/LOOP-HELPERS.html">
                                      Loop Helpers
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/FUNCTIONS/ARRAY-HELPERS.html">
                                      Array Helpers
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/FUNCTIONS/LINK-HELPERS.html">
                                      Link Helpers
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/FUNCTIONS/URI-HELPERS.html">
                                      Uri Helpers
                                  </a>
                              </li>
                                                </ul>
                    </li>
                                    <li>
                      <a class="section" href="#sidebar-wrapper"><i class="fa fa-caret-right"></i> Extending Foil</a>
                      <ul>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/EXTENDING/FUNCTIONS-AND-FILTERS.html">
                                      Custom Functions and Filters
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/EXTENDING/CUSTOM-EXTENSIONS.html">
                                      Custom Foil Extensions
                                  </a>
                              </li>
                                                </ul>
                    </li>
                                    <li>
                      <a class="section" href="#sidebar-wrapper"><i class="fa fa-caret-right"></i> Integrate Foil</a>
                      <ul>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/INTEGRATE/OVERVIEW.html">
                                      Overview
                                  </a>
                              </li>
                                                        <li class="">
                                  <a href="http://www.foilphp.it/docs/INTEGRATE/API.html">
                                      API Functions
                                  </a>
                              </li>
                                                </ul>
                    </li>
                                        </ul>
      </div>
      <!-- /#sidebar-wrapper -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <div class="container-fluid">
                <div class="row">
                    <div id="content" class="col-lg-11">
                                                <ol class="breadcrumb">
                          <li><a href="http://www.foilphp.it">Foil</a></li>
                          <li class="active">Data</li>
                        </ol>
                                                <!--
currentMenu: "retrievedata"
currentSection: "Data"
title: "Retrieve Data Inside Templates"
-->
<h1>Retrieve Data Inside Templates</h1>
<p>There are two main ways to retrieve data inside a template</p>
<ul>
<li>get data as template instance properties (accessed via <code>$this</code>)</li>
<li>use helpers</li>
</ul>
<p>The latter is explained in the <em>"Data / Helpers"</em> docs section.</p>
<p>First method is easily explained via an example.</p>
<p>Assuming a Foil template rendering is launched like so:</p>
<pre><code class="language-php">Foil\engine(['folders' =&gt; 'path/to/templates'])
  -&gt;render('template-example', ['foo' =&gt; 'Bar', 'bar' =&gt; 'Baz']);</code></pre>
<p>inside <code>template-example.php</code></p>
<pre><code class="language-php">echo $this-&gt;foo;</code></pre>
<p>outputs "Bar".</p>
<p>It worth noting that if a variable is not defined, no notice or warning is thrown, saving you from check for variable existence.</p>
<p>E.g. in previous example</p>
<pre><code class="language-php">echo $this-&gt;a_non_defined_var;</code></pre>
<p>will just echo nothing.</p>
<h2>Automatic Escaping</h2>
<p>By default, template data is automatically escaped, i.e. it is HTML-encoded with support for UTF-8.</p>
<p>Assuming a Foil template rendering is launched like so:</p>
<pre><code class="language-php">Foil\engine(['folders' =&gt; 'path/to/templates'])
  -&gt;render('template-example', ['bold' =&gt; '&lt;strong&gt;I am "bold"&lt;/strong&gt;']);</code></pre>
<p>inside the template <code>$this-&gt;bold</code> will be equal to</p>
<pre><code class="language-html">&amp;lt;strong&amp;gt;I am &amp;quot;bold&amp;quot;&amp;lt;/strong&amp;gt;</code></pre>
<h2>Automatic Escaping Gotchas</h2>
<p>Given that escape data that may possibly come from user input (even when saved in a database) <strong>is really important</strong> to avoid vulnerability to XSS attacks,
you need to be sure <strong>all</strong> strings you output are escaped. For the purpose you need to make a choice:</p>
<ul>
<li>Turn automatic escape OFF, and remember to use escape helpers to escape <strong>anything</strong> before output to HTML</li>
<li>Leave automatic escape ON, and be sure to carefully read following paragraphs to understand Foil automatic escape limitations and practices to overcome them</li>
</ul>
<blockquote>
<p><strong>Foil is capable to automatically escape only strings and arrays (even deeply nested) that contain strings.</strong></p>
</blockquote>
<p>If you use objects as template context and use that object vars or methods to output strings, those strings <strong>can't</strong> be automatically escaped by Foil.</p>
<p>So, if you want to use Foil automatic escape you have 2 options to choose from:</p>
<ul>
<li>be sure that any object whose methods or properties are used in template outputs escaped content</li>
<li>only pass arrays or strings as template data</li>
</ul>
<p>The second option may appear limiting, because a lot of times template data comes from persistent data layer (mostly database) libraries that return objects.</p>
<p>However, convert that collections of objects into array before passing them to a Foil template is all but a bad idea, because:</p>
<ul>
<li>it will make you able to use automatic escape with no worries</li>
<li>it will make printing data a lot easier, thanks to the dot syntax support that Foil helpers provide for nested arrays (see <em>"Data / Helpers"</em> to know more on the topic)</li>
<li>it will decouple your templates from data layer objects, improving maintainability and general quality of your code</li>
</ul>
<h2>Introducing <em>Arraization</em></h2>
<p>Foil has a simple, but pretty powerful tool to converts any kind of data into an array.</p>
<p>(Of course, you are not forced to use it, in fact you can use any method or any library you like for the purpose.)</p>
<p>The <em>Foil way</em> is pretty simple but powerful, it is accessed via a single function: <strong><code>arraize()</code></strong>.</p>
<p>It does the conversion is done in very flexible way that may work out of the box with a lot of libraries. (Just as example it will work out of the box with <a href="http://laravel.com/docs/4.2/eloquent">Eloquent</a> models).</p>
<p>I want to remark that to use this system is absolutely <strong>not required</strong> to use Foil.</p>
<p>For this reason, and also to make it more readable, full explanation on how <code>arraize()</code> works is in a separate docs section, if you're interested see <em>"Data / Arraization"</em>.</p>
<h2>Double Quote Around HTML Attributes</h2>
<p>No matter if you escape a variable thanks to automatic escaping or using escape helpers, when you output something inside HTML attributes is <strong>important</strong> that you wrap it using <strong>double quotes</strong>:</p>
<pre><code class="language-html">&lt;!-- double quotes: GOOD --&gt;
&lt;div id="&lt;?= $this-&gt;autoescaped_string ?&gt;"&gt;

&lt;!-- double quotes: GOOD --&gt;
&lt;div id="&lt;?= $this-&gt;e('a_string') ?&gt;"&gt;

&lt;!-- single quotes: BAD --&gt;
&lt;div id='&lt;?= $this-&gt;e("a_string") ?&gt;'&gt;

&lt;!-- no quotes: BAD --&gt;
&lt;div id=&lt;?= $this-&gt;escape($a_string) ?&gt;&gt;</code></pre>
<p><code>e()</code> and <code>escape()</code> helpers are documented in <em>"Data/ Helpers"</em> docs section.</p>
<h2>Turn Automatic Escape Off</h2>
<p>Automatic escape can be turned off by setting <code>"autoescape"</code> engine option to false:</p>
<pre><code class="language-php">$engine = Foil\engine([
  'folders'    =&gt; 'path/to/templates',
  'autoescape' =&gt; false                // turn autoescape off
])</code></pre>
<h2>Raw Output</h2>
<p>To output HTML content when autoescape is turned on, is possible to use <code>raw()</code> template function</p>
<pre><code class="language-php">$this-&gt;raw('some_html_content');</code></pre>
<p>Code above will return the string saved in <code>$this-&gt;some_html_content</code> with non-escaped HTML tags.</p>
<p>Just <strong>be sure to sanitize any content possibly coming from users</strong> when using this function.</p>
<p><code>raw()</code> is one of the Foil template helpers, there are some and all are documented in <em>"Data / Helpers"</em> section.</p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /#page-content-wrapper -->

                    <a href="https://github.com/Giuseppe-Mazzapica/Foil">
                <img style="position:fixed; top:0; right:0; border:0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png">
            </a>
                <a href="#" id="menu-toggle" title="Toggle Menu"><i class="fa fa-bars"></i></a>


    </div>
    <!-- /#wrapper -->

    <footer class="footer hidden-xs hidden-sm">
      Made by hands by
      <a href="http://gm.zoomlab.it/" title="Giuseppe Mazzapica Home Page" target="_blank">Giuseppe Mazzapica</a>, with
      <a href="http://couscous.io/" title="Couscous" target="_blank">Couscous</a>,
      <a href="http://getbootstrap.com/" title="Bootstrap" target="_blank">Bootstrap</a> &amp;
      <a href="https://highlightjs.org/" title="highlight.js" target="_blank">highlight.js</a>

      <span class="socials">
        <a href="https://github.com/Giuseppe-Mazzapica" title="GitHub" target="_blank"><i class="fa fa-github-alt"></i></a>
        <a href="https://twitter.com/gmazzap" title="Twitter" target="_blank"><i class="fa fa-twitter"></i></a>
        <a href="http://wordpress.stackexchange.com/users/35541/" title="Stack Exchange" target="_blank"><i class="fa fa-stack-exchange"></i></a>
      </span>

    </footer>

    <a href="#wrapper" class="hidden-xs hidden-sm" id="back-top" title="Back to top"><i class="fa fa-long-arrow-up"></i></a>
    <script src="http://yandex.st/highlightjs/7.5/highlight.min.js"></script>
    <script src="http://www.foilphp.it/js/theme.min.js"></script>


</body>

</html>
